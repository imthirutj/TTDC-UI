<div class="container">
    <h2 class="mt-4">Employee Shift Calendar</h2>


    <div class="card">
        <app-filter [filters]="filters" (filterChanged)="onFilterChanged($event)"
            (triggerParentFunction)="fetchEmployeeStatus()">
        </app-filter>
        <button style="width:77px" class="btn btn-primary" (click)="search()">Search</button>
    </div>

    <br>


    <!-- Employee Shifts Table -->
    <div style="overflow-y: auto; max-height: 500px;">
        <table class="table table-bordered">
            <thead class="sticky-header">
                <tr>
                    <th>Employee</th>
                    <th>#</th>
                    <th *ngFor="let date of getCurrentDates()">
                        <!-- Show date as MM-DD -->
                        {{ date | date: 'dd MMM YYYY' }}
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let employee of employees">
                    <td>{{ employee.employeeName }}</td>
                    <td><button class="btn btn-primary">Details</button></td>
                    <td *ngFor="let date of getCurrentDates()">
                        <!-- First and Last Biometric Data -->
                        <div *ngIf="employee.dates[date].biometricData && employee.dates[date].biometricData.length">
                            <!-- First biometric record (In time) -->
                            <div *ngIf="employee.dates[date].biometricData[0]">
                                <p> {{ employee.dates[date].biometricData[0].type}}: {{
                                    employee.dates[date].biometricData[0].time }}</p>
                            </div>
                            <!-- Last biometric record (Out time) -->
                            <div
                                *ngIf="employee.dates[date].biometricData[employee.dates[date].biometricData.length - 1]">
                                <p> {{employee.dates[date].biometricData[employee.dates[date].biometricData.length -
                                    1].type }}: {{
                                    employee.dates[date].biometricData[employee.dates[date].biometricData.length -
                                    1].time }}</p>
                            </div>
                        </div>

                        <!-- Status Dropdown -->
                        <select class="form-select" [(ngModel)]="employee.dates[date].status">
                            <option value="">Select</option>
                            <option *ngFor="let st of getStatusOptions(date)" [value]="st.key">{{ st.value }}</option>
                        </select>
                        <!-- <button class="btn-primary">Update</button> -->
                    </td>
                </tr>
            </tbody>
        </table>
    </div>



    <!-- Pagination Controls -->
    <!-- Pagination Controls -->
    <div class="d-flex justify-content-between">
        <button class="btn btn-secondary" (click)="prevPage()" [disabled]="currentPage === 0">Previous</button>
        <button class="btn btn-secondary" (click)="nextPage()" [disabled]="currentPage === totalPages - 1">Next</button>
    </div>

    <button class="btn btn-primary" (click)="saveShifts()">Save Shifts</button>
</div>